<!DOCTYPE html>
<html>
<head>
	<title>Graffiti Viz</title>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	<script type="text/javascript" src="libs/highcharts.js"></script>
	<script type="text/javascript" src="libs/miso.ds.deps.min.0.2.1.js"></script>

	<script type="text/javascript">
		//JQuery wait for DOM to load

			var dateColumn;
			var ManCreated;
			var ManClosed;
			var BkCreated;
			var BkClosed;
			var QnCreated;
			var QnClosed;
			var SiCreated;
			var SiClosed;
			var BxCreated;
			var BxClosed;
		$(document).ready(function() {

			var dsMan = new Miso.Dataset({
			  url : "data/gr_Manhattan.csv",
			  delimiter : ","
			});

			dsMan.fetch({
			  success : function() {
			  	dateColumn = this.column('Date').data
			  	ManCreated = this.column("CreatedIncidents").data;
			  	ManClosed = this.column("ClosedIncidents").data;


			    var chart = new Highcharts.Chart({
			      chart: {
			        renderTo: 'vizContainerMan',
			        type: 'column',
			        marginRight: 130,
			        marginBottom: 25
			      },
			      title: {
			        text: 'Graffiti tags in Manhattan',
			        x: -20, //center
			        style:{
						color:'#303030',
						font: 'normal 18px "Arial", sans-serif'
					}
			      },
			      subtitle: {
			        text: '',
			        x: -20
			      },
			      plotOptions:{
			      	series:{
			      		borderWidth: 0,
						shadow:false
			      	}
			      },
			      xAxis: {
			        categories: this.column('Date').data,
			        labels:{
			        	style:{
			        		font: 'normal 10px "Arial", sans-serif'
			        	}
			        }
			      },
			      yAxis: {
			      	max: 750,
			        title: {
			          text: 'Number of Incidents',
			          	style: {
							color:'#303030',
							font: 'normal 13px "Arial", sans-serif'
				
						}
			        }
			      },
			      tooltip: {
			        formatter: function() {
			          return '<b>'+ this.series.name +'</b><br/>'+
			          this.x +': '+ this.y;
			        },
					borderRadius:1,
					borderWidth:1,
					shadow:false
			      },
			      legend: {
			          layout: 'vertical',
			          align: 'right',
			          verticalAlign: 'top',
			          x: -150,
			          y: -10,
			          borderWidth: 0
			      },
			      series: [{
			          name: 'New incidents',
			          color: 'blue',
			          data: ManCreated
			      },
			      {
			          name: 'Closed incidents',
			          color: '#FA9FB5',
			          data: ManClosed
			      }]
			    });
			  }
			}); //end miso.fetch
	
			//BEGIN BROOKLYN
			var dsBk = new Miso.Dataset({
			  url : "data/gr_Brooklyn.csv",
			  delimiter : ","
			});

			dsBk.fetch({
			  success : function() {
			  	BkCreated = this.column("CreatedIncidents").data;
			  	BkClosed = this.column("ClosedIncidents").data;

			    var chart = new Highcharts.Chart({
			      chart: {
			        renderTo: 'vizContainerBk',
			        type: 'column',
			        marginRight: 130,
			        marginBottom: 25
			      },
			      title: {
			        text: 'Graffiti tags in Brooklyn',
			        x: -20, //center
			        style:{
						color:'#303030',
						font: 'normal 18px "Arial", sans-serif'
					}
			      },
			      subtitle: {
			        text: '',
			        x: -20
			      },
			      plotOptions:{
			      	series:{
			      		borderWidth: 0,
						shadow:false
			      	}
			      },
			      xAxis: {
			        categories: this.column('Date').data,
			        labels:{
			        	style:{
			        		font: 'normal 10px "Arial", sans-serif'
			        	}
			        }
			      },
			      yAxis: {
			      	max: 750,
			        title: {
			          text: 'Number of Incidents',
			          	style: {
							color:'#303030',
							font: 'normal 13px "Arial", sans-serif'
				
						}
			        }
			      },
			      tooltip: {
			        formatter: function() {
			          return '<b>'+ this.series.name +'</b><br/>'+
			          this.x +': '+ this.y;
			        },
					borderRadius:1,
					borderWidth:1,
					shadow:false
			      },
			      legend: {
			          layout: 'vertical',
			          align: 'right',
			          verticalAlign: 'top',
			          x: -150,
			          y: -10,
			          borderWidth: 0
			      },
			      series: [{
			          name: 'New incidents',
			          color: '#31A354',
			          data: BkCreated
			      },{
			          name: 'Closed incidents',
			          color: '#ADDD8E',
			          data: BkClosed
			      }]
			    });
			  }
			}); //end miso.fetch

			var dsQn = new Miso.Dataset({
			  url : "data/gr_Queens.csv",
			  delimiter : ","
			});

			dsQn.fetch({
			  success : function() {
			  	QnCreated = this.column("CreatedIncidents").data;
			  	QnClosed = this.column("ClosedIncidents").data;

			    var chart = new Highcharts.Chart({
			      chart: {
			        renderTo: 'vizContainerQn',
			        type: 'column',
			        marginRight: 130,
			        marginBottom: 25
			      },
			      title: {
			        text: 'Graffiti tags in Queens',
			        x: -20, //center
			        style:{
						color:'#303030',
						font: 'normal 18px "Arial", sans-serif'
					}
			      },
			      subtitle: {
			        text: '',
			        x: -20
			      },
			      plotOptions:{
			      	series:{
			      		borderWidth: 0,
						shadow:false
			      	}
			      },
			      xAxis: {
			        categories: this.column('Date').data,
			        labels:{
			        	style:{
			        		font: 'normal 10px "Arial", sans-serif'
			        	}
			        }
			      },
			      yAxis: {
			      	max: 750,
			        title: {
			          text: 'Number of Incidents',
			          	style: {
							color:'#303030',
							font: 'normal 13px "Arial", sans-serif'
				
						}
			        }
			      },
			      tooltip: {
			        formatter: function() {
			          return '<b>'+ this.series.name +'</b><br/>'+
			          this.x +': '+ this.y;
			        },
					borderRadius:1,
					borderWidth:1,
					shadow:false
			      },
			      legend: {
			          layout: 'vertical',
			          align: 'right',
			          verticalAlign: 'top',
			          x: -150,
			          y: -10,
			          borderWidth: 0
			      },
			      series: [{
			          name: 'New incidents',
			          color: '#08519C',
			          data: QnCreated
			      },
			      {
			          name: 'Closed incidents',
			          color: '#6BAED6',
			          data: QnClosed
			      }]
			    });
			  }
			}); //end miso.fetch

			//BEGIN STATEN ISLAND
			var dsSi = new Miso.Dataset({
			  url : "data/gr_StatenIsland.csv",
			  delimiter : ","
			});

			dsSi.fetch({
			  success : function() {
			  	SiCreated = this.column("CreatedIncidents").data;
			  	SiClosed = this.column("ClosedIncidents").data;

			    var chart = new Highcharts.Chart({
			      chart: {
			        renderTo: 'vizContainerSi',
			        type: 'column',
			        marginRight: 130,
			        marginBottom: 25
			      },
			      title: {
			        text: 'Graffiti tags in Staten Island',
			        x: -20, //center
			        style:{
						color:'#303030',
						font: 'normal 18px "Arial", sans-serif'
					}
			      },
			      subtitle: {
			        text: '',
			        x: -20
			      },
			      plotOptions:{
			      	series:{
			      		borderWidth: 0,
						shadow:false
			      	}
			      },
			      xAxis: {
			        categories: this.column('Date').data,
			        labels:{
			        	style:{
			        		font: 'normal 10px "Arial", sans-serif'
			        	}
			        }
			      },
			      yAxis: {
			      	max: 750,
			        title: {
			          text: 'Number of Incidents',
			          	style: {
							color:'#303030',
							font: 'normal 13px "Arial", sans-serif'
				
						}
			        }
			      },
			      tooltip: {
			        formatter: function() {
			          return '<b>'+ this.series.name +'</b><br/>'+
			          this.x +': '+ this.y;
			        },
					borderRadius:1,
					borderWidth:1,
					shadow:false
			      },
			      legend: {
			          layout: 'vertical',
			          align: 'right',
			          verticalAlign: 'top',
			          x: -150,
			          y: -10,
			          borderWidth: 0
			      },
			      series: [{
			          name: 'New incidents',
			          color: '#D95F0E',
			          data: SiCreated
			      },
			      {
			          name: 'Closed incidents',
			          color: '#FE9929',
			          data: SiClosed
			      }]
			    });
			  }
			}); //end miso.fetch

			//BEGIN BRONX
			var dsBx = new Miso.Dataset({
			  url : "data/gr_Bronx.csv",
			  delimiter : ","
			});

			dsBx.fetch({
			  success : function() {
			  	BxCreated = this.column("CreatedIncidents").data;
			  	BxClosed = this.column("ClosedIncidents").data;

			    var chart = new Highcharts.Chart({
			      chart: {
			        renderTo: 'vizContainerBx',
			        type: 'column',
			        marginRight: 130,
			        marginBottom: 25
			      },
			      title: {
			        text: 'Graffiti tags in the Bronx',
			        x: -20, //center
			        style:{
						color:'#303030',
						font: 'normal 18px "Arial", sans-serif'
					}
			      },
			      subtitle: {
			        text: '',
			        x: -20
			      },
			      plotOptions:{
			      	series:{
			      		borderWidth: 0,
						shadow:false
			      	}
			      },
			      xAxis: {
			        categories: this.column('Date').data,
			        labels:{
			        	style:{
			        		font: 'normal 10px "Arial", sans-serif'
			        	}
			        }
			      },
			      yAxis: {
			      	max: 750,
			        title: {
			          text: 'Number of Incidents',
			          	style: {
							color:'#303030',
							font: 'normal 13px "Arial", sans-serif'
				
						}
			        }
			      },
			      tooltip: {
			        formatter: function() {
			          return '<b>'+ this.series.name +'</b><br/>'+
			          this.x +': '+ this.y;
			        },
					borderRadius:1,
					borderWidth:1,
					shadow:false
			      },
			      legend: {
			          layout: 'vertical',
			          align: 'right',
			          verticalAlign: 'top',
			          x: -150,
			          y: -10,
			          borderWidth: 0
			      },
			      series: [{
			          name: 'New incidents',
			          color: '#8856A7',
			          data: BxCreated
			      },
			      {
			          name: 'Closed incidents',
			          color: '#8C96C6',
			          data: BxClosed
			      }]
			    });

		// City trends
		// Created cases
		var cityChartCreated = new Highcharts.Chart({
			      chart: {
			        renderTo: 'vizContainerCityCreated',
			        type: 'line',
			        marginRight: 130,
			        marginBottom: 25
			      },
			      title: {
			        text: 'Graffiti tags in the Bronx',
			        x: -20, //center
			        style:{
						color:'#303030',
						font: 'normal 18px "Arial", sans-serif'
					}
			      },
			      subtitle: {
			        text: '',
			        x: -20
			      },
			      plotOptions:{
			      	series:{
			      	}
			      },
			      xAxis: {
			        categories: dateColumn,
			        labels:{
			        	style:{
			        		font: 'normal 10px "Arial", sans-serif'
			        	}
			        }
			      },
			      yAxis: {
			      	max: 750,
			        title: {
			          text: 'Number of Incidents',
			          	style: {
							color:'#303030',
							font: 'normal 13px "Arial", sans-serif'
				
						}
			        }
			      },
			      tooltip: {
			        formatter: function() {
			          return '<b>'+ this.series.name +'</b><br/>'+
			          this.x +': '+ this.y;
			        },
					borderRadius:1,
					borderWidth:1,
					shadow:false
			      },
			      legend: {
			          layout: 'vertical',
			          align: 'right',
			          verticalAlign: 'top',
			          x: -150,
			          y: -10,
			          borderWidth: 0
			      },
			      series: [{
			          name: 'Created in Manhattan',
			          // color: '#8856A7',
			          data: ManCreated
			      },
			      {
			          name: 'Created in Brooklyn',
			          // color: '#8856A7',
			          data: BkCreated
			      },
			      {
			          name: 'Created in Queens',
			          // color: '#8856A7',
			          data: QnCreated
			      },
			      {
			          name: 'Created in Staten Island',
			          // color: '#8856A7',
			          data: SiCreated
			      },
			      {
			          name: 'Created in the Bronx',
			          // color: '#8856A7',
			          data: BxCreated
			      }
			      ]
			    });

			  } // end miso success callback
			}); //end miso.fetch


		
		var cityCharts = function()


		}); //end document ready


	</script>
<style>
	.vizContainer{
		width:100%;
		height:300px;
		float:left;
		margin-bottom: 25px;
	}
</style>
</head>
<body>
	<div id="vizContainerCityCreated" class="vizContainer"></div>
	<div id="vizContainerCityClosed" class="vizContainer"></div>
	<div id="vizContainerMan" class="vizContainer"></div>
	<div id="vizContainerBk" class="vizContainer"></div>
	<div id="vizContainerQn" class="vizContainer"></div>
	<div id="vizContainerSi" class="vizContainer"></div>
	<div id="vizContainerBx" class="vizContainer"></div>

</body>
</html>